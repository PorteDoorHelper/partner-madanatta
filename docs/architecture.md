# Архитектура проекта DoorPartner

Этот документ описывает общую архитектуру проекта DoorPartner и стек применяемых технологий.

## Содержание

1. [Общий обзор](#общий-обзор)
2. [Технологический стек](#технологический-стек)
3. [Архитектура приложения](#архитектура-приложения)
4. [Структура проекта](#структура-проекта)
5. [Ключевые компоненты](#ключевые-компоненты)
6. [Локализация](#локализация)
7. [Темизация](#темизация)
8. [Маршрутизация](#маршрутизация)
9. [Стилизация](#стилизация)
10. [Развертывание](#развертывание)
11. [Рекомендации по расширению](#рекомендации-по-расширению)

## Общий обзор

DoorPartner — это веб-приложение для дилеров интерьерных дверей в Канаде. Проект построен на современном стеке технологий с использованием Next.js 15 и React 19. Приложение предоставляет многоязычный интерфейс, адаптивный дизайн и поддержку светлой/темной темы.

Архитектура проекта основана на принципах:
- **Компонентный подход** — разделение интерфейса на переиспользуемые компоненты
- **Server-first** — максимальное использование серверных компонентов Next.js
- **Интернационализация** — полная поддержка многоязычности
- **Темизация** — централизованное управление темами и стилями
- **Масштабируемость** — архитектура, позволяющая легко расширять функциональность

## Технологический стек

### Фронтенд

- **React 19** — библиотека для создания пользовательских интерфейсов
- **Next.js 15** — фреймворк для React с поддержкой серверного рендеринга
- **TypeScript** — типизированный JavaScript для повышения надежности кода
- **Tailwind CSS** — утилитарный CSS-фреймворк для стилизации
- **shadcn/ui** — библиотека компонентов на основе Radix UI и Tailwind CSS
- **next-themes** — библиотека для управления темами в Next.js
- **Lucide React** — библиотека иконок

### Инструменты разработки

- **ESLint** — статический анализатор кода
- **Prettier** — форматирование кода
- **npm** — менеджер пакетов

## Архитектура приложения

Приложение построено на основе архитектуры Next.js App Router, которая предоставляет:

1. **Файловую маршрутизацию** — структура папок определяет маршруты приложения
2. **Серверные компоненты** — большинство компонентов рендерятся на сервере
3. **Клиентские компоненты** — интерактивные компоненты с директивой 'use client'
4. **Параллельные маршруты** — поддержка нескольких представлений на одном URL
5. **Интерцепторы маршрутов** — перехват навигации для модальных окон и т.д.

### Схема архитектуры

\`\`\`
                   ┌─────────────────┐
                   │    Клиент       │
                   └────────┬────────┘
                            │
                            ▼
┌───────────────────────────────────────────────┐
│                  Next.js                      │
│  ┌─────────────┐    ┌─────────────────────┐   │
│  │  App Router │◄───┤ Middleware (Locale) │   │
│  └──────┬──────┘    └─────────────────────┘   │
│         │                                     │
│         ▼                                     │
│  ┌─────────────┐    ┌─────────────────────┐   │
│  │  Серверные  │◄───┤     Локализация     │   │
│  │ компоненты  │    │   (getDictionary)   │   │
│  └──────┬──────┘    └─────────────────────┘   │
│         │                                     │
│         ▼                                     │
│  ┌─────────────┐    ┌─────────────────────┐   │
│  │ Клиентские  │◄───┤      Темизация      │   │
│  │ компоненты  │    │   (ThemeProvider)   │   │
│  └─────────────┘    └─────────────────────┘   │
└───────────────────────────────────────────────┘
\`\`\`

## Структура проекта

\`\`\`
door-dealership/
├── app/                    # Основные компоненты приложения (App Router)
│   ├── [lang]/             # Динамический маршрут для локализации
│   │   ├── layout.tsx      # Макет для локализованных страниц
│   │   └── page.tsx        # Главная страница
│   ├── globals.css         # Глобальные стили
│   └── layout.tsx          # Корневой макет
├── components/             # Переиспользуемые компоненты
│   ├── ui/                 # UI компоненты (shadcn/ui)
│   ├── header.tsx          # Компонент заголовка
│   ├── language-switcher.tsx # Переключатель языков
│   ├── mobile-menu.tsx     # Мобильное меню
│   └── theme-provider.tsx  # Провайдер темы
├── docs/                   # Документация
├── lib/                    # Утилиты и конфигурации
│   ├── i18n.ts             # Конфигурация локализации
│   ├── theme.ts            # Конфигурация темы
│   └── utils.ts            # Вспомогательные функции
├── messages/               # Файлы локализации
│   ├── en.json             # Английский язык
│   └── fr.json             # Французский язык
├── middleware.ts           # Middleware для обработки локализации
├── next.config.js          # Конфигурация Next.js
├── package.json            # Зависимости проекта
├── tailwind.config.ts      # Конфигурация Tailwind CSS
└── tsconfig.json           # Конфигурация TypeScript
\`\`\`

## Ключевые компоненты

### Серверные компоненты

- **app/[lang]/layout.tsx** — основной макет приложения, включает ThemeProvider и Header
- **app/[lang]/page.tsx** — главная страница приложения

### Клиентские компоненты

- **components/header.tsx** — заголовок сайта с навигацией
- **components/language-switcher.tsx** — компонент для переключения языков
- **components/mobile-menu.tsx** — мобильное меню для маленьких экранов
- **components/theme-switcher.tsx** — компонент для переключения тем
- **components/theme-provider.tsx** — провайдер для управления темами

### Утилиты и конфигурации

- **lib/i18n.ts** — утилиты для работы с локализацией
- **lib/theme.ts** — конфигурация темы приложения
- **middleware.ts** — обработка локализации на уровне маршрутизации

## Локализация

Система локализации построена на следующих принципах:

1. **Динамические маршруты** — URL содержит код языка (например, `/en/about`)
2. **Файлы локализации** — JSON-файлы с переводами в директории `messages/`
3. **Middleware** — автоматическое определение языка пользователя
4. **Серверные функции** — `getDictionary()` для получения переводов
5. **Переключатель языков** — компонент для смены языка интерфейса

### Пример использования локализации:

\`\`\`typescript
// Получение словаря переводов
const dictionary = await getDictionary(lang)

// Использование переводов
<h1>{dictionary.hero.title}</h1>
\`\`\`

## Темизация

Система темизации включает:

1. **Централизованная конфигурация** — файл `lib/theme.ts` с настройками темы
2. **CSS переменные** — определены в `globals.css`
3. **ThemeProvider** — компонент для управления темами на основе next-themes
4. **ThemeSwitcher** — компонент для переключения между светлой и темной темами

### Пример использования темы:

\`\`\`typescript
// Импорт темы
import { theme } from "@/lib/theme"

// Использование параметров темы
<div style={{ color: theme.colors.primary.DEFAULT }}>
  Текст основного цвета
</div>
\`\`\`

## Маршрутизация

Маршрутизация основана на файловой системе Next.js App Router:

1. **Динамические маршруты** — папки с именами в квадратных скобках, например `[lang]`
2. **Параметры маршрута** — доступны через props компонентов
3. **Middleware** — обработка маршрутов до рендеринга страницы
4. **Генерация статических путей** — функция `generateStaticParams()`

### Пример маршрутизации:

\`\`\`typescript
// Определение статических путей для локализации
export async function generateStaticParams() {
  return locales.map((lang) => ({ lang }))
}

// Использование параметров маршрута
export default function Page({ params }: { params: { lang: string } }) {
  const lang = params.lang
  // ...
}
\`\`\`

## Стилизация

Стилизация основана на Tailwind CSS с дополнительными настройками:

1. **Утилитарные классы** — основной способ стилизации компонентов
2. **Компоненты shadcn/ui** — предварительно стилизованные компоненты
3. **CSS переменные** — для динамического изменения стилей
4. **Темы** — поддержка светлой и темной темы
5. **Кастомные классы** — определены в `globals.css`

### Пример стилизации:

\`\`\`tsx
<button className="bg-primary text-white px-4 py-2 rounded-md hover:bg-primary-dark transition-colors">
  Кнопка
</button>
\`\`\`

## Развертывание

Проект можно развернуть на различных платформах:

1. **Vercel** — оптимальный вариант для Next.js приложений
2. **Netlify** — альтернативный вариант с поддержкой Next.js
3. **Самостоятельный хостинг** — с использованием Node.js сервера

### Шаги для развертывания на Vercel:

1. Подключите репозиторий к Vercel
2. Настройте переменные окружения (если необходимо)
3. Выберите ветку для развертывания
4. Запустите процесс сборки и развертывания

## Рекомендации по расширению

### Добавление новых страниц

1. Создайте новый файл `page.tsx` в соответствующей директории
2. Добавьте переводы для новой страницы в файлы локализации
3. Обновите навигацию в компоненте Header

### Добавление новых компонентов

1. Создайте новый компонент в директории `components/`
2. Используйте параметры темы из `lib/theme.ts`
3. Добавьте поддержку локализации, если необходимо

### Добавление новых языков

1. Создайте новый файл локализации в директории `messages/`
2. Добавьте новый язык в массив `locales` в файле `lib/i18n.ts`
3. Обновите компонент LanguageSwitcher

### Интеграция с API

1. Создайте директорию `app/api/` для API-маршрутов
2. Используйте серверные действия (Server Actions) для обработки форм
3. Добавьте клиентские хуки для взаимодействия с API

### Оптимизация производительности

1. Используйте серверные компоненты где возможно
2. Применяйте ленивую загрузку для тяжелых компонентов
3. Оптимизируйте изображения с помощью компонента `next/image`
4. Используйте кэширование данных с помощью React Query или SWR

## Заключение

Архитектура проекта DoorPartner обеспечивает гибкость, масштабируемость и удобство разработки. Использование современных технологий и подходов позволяет создать высококачественное веб-приложение с поддержкой многоязычности и темизации.
